<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: proteomics_cpp/bin/toppic_resources/topview/js/spectrum_graph/spectrumgraph.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: proteomics_cpp/bin/toppic_resources/topview/js/spectrum_graph/spectrumgraph.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// maximum number of peaks and envelopes points to be renderedon to graph per each bin(range)
const circlesPerRange = 200;
const peaksPerRange = 200;
/**
 * Function draws the graph, binds zoom and drag function to the graph
 * @param {String} svgId - SVG id on which the graph needed to be drawn
 * @param {object} spectrumParameters - Contains the parameters like height, width etc.,. tht helps to draw the graph
 * @param {list} peakData - contains peakList and envelope list 
 * @param {list} ionData - Contains data with mass and ACID name to plot on the graph
 */
SpectrumGraph = function(svgId,spectrumParameters,peakData, ionData){
	this.svg = d3.select("body").select(svgId);
  	this.id = svgId;
  	this.para = spectrumParameters;
	this.data = peakData;
	this.ionData = ionData;
	let graph = this;
	let tempid = svgId.split("#")[1];
	this.redraw = function(mono_mz,graphFeatures){
		this.para = compSpectrumParameters(this.data.peak_list, this.data.envelope_list, mono_mz);
		this.para.graphFeatures = graphFeatures;
		spectrumParameters = drawSpectrum(this.id, this.para, this.data,this.ionData);
		//Copying as a new variable than referencing. Referencing will change the properties of parent if child properties are changes
		correspondingSpecParams_g[tempid] = jQuery.extend(true, {}, spectrumParameters);
	}

	this.zoomed = function () {
		let transform = d3.event.transform;
		let distance = transform.x - spectrumParameters.specX;
		let ratio = transform.k / spectrumParameters.specScale;
		spectrumParameters.specX = transform.x;
		spectrumParameters.specScale = transform.k;
		let mousePos = d3.mouse(this);
		if(ratio == 1) {
			spectrumParameters.drag(distance);
		}
		else{
			spectrumParameters.zoom(mousePos[0], mousePos[1], ratio);
		}
		spectrumParameters = drawSpectrum(svgId, spectrumParameters, peakData, ionData);
		//Copying as a new variable than referencing. Referencing will change the properties of parent if child properties are changes
		correspondingSpecParams_g[tempid] = jQuery.extend(true, {}, spectrumParameters);
	}

	this.zoom = d3.zoom()
		.on("zoom", this.zoomed);
	this.svg.attr("viewBox", "0 0 "+ spectrumParameters.svgWidth+" "+ spectrumParameters.svgHeight)
					.attr("width", "100%")
					.attr("height", "100%")
					.call(this.zoom);
	this.svg.call(this.zoom.transform, d3.zoomIdentity);

	spectrumParameters = drawSpectrum(svgId, spectrumParameters, peakData, ionData); 
	//Copying as a new variable than referencing. Referencing will change the properties of parent if child properties are changes
	correspondingSpecParams_g[tempid] = jQuery.extend(true, {}, spectrumParameters);

	return graph;
}
/**
 * Function that draws ticks on x-axis and y-axis
 * @param{node} svg -  is a html node on which the graph is being ploted
 */
drawTicks = function(svg,spectrumParameters){
	// Creating a group under svg node with id 'ticks' under which ticks are drawn 
	this.addXTicks = svg.append("g").attr("id","ticks");
	for(let i=0; i &lt;= spectrumParameters.xTicks ; i++)
	{
		// Get the default tick width and calculate the actual tick width position based on the current minMz value on the xaxis
		let tickWidth = spectrumParameters.getTickWidth();
		if(tickWidth &lt; 1 &amp;&amp; tickWidth != 0)
		{
			tickWidth = (i*tickWidth + spectrumParameters.minMz) - parseFloat((i*tickWidth + spectrumParameters.minMz)%tickWidth) ;
		}
		else if(tickWidth != 0)
		{
			tickWidth = i*tickWidth + spectrumParameters.minMz - (i*tickWidth + spectrumParameters.minMz)%tickWidth ;
		}
		// get the x position of the tick 
		x = spectrumParameters.getPeakXPos(tickWidth);
		// Below condition helps the ticks to be to the right of the y - axis 
		if(x >= spectrumParameters.padding.left &amp;&amp; 
				x &lt;= (spectrumParameters.svgWidth - spectrumParameters.padding.right))
		{
			this.addXTicks.append("line")
							.attr("x1",x)
							.attr("y1",spectrumParameters.svgHeight -spectrumParameters.padding.bottom)
							.attr("x2",x)
							.attr("y2",spectrumParameters.svgHeight -spectrumParameters.padding.bottom + spectrumParameters.ticklength)
							.attr("stroke","black")
							.attr("stroke-width","1")
		}
	}
	this.addYTicks = svg.append("g").attr("id","ticks")
									.attr("class","ticks");
	for(let i=0; i &lt;= spectrumParameters.yTicks ; i++)
	{
		// Get the default tick height and calculate the actual tick height position
		let tickHeight = spectrumParameters.getTickHeight();
		tickHeight = i*tickHeight * spectrumParameters.dataMaxInte /100;
		tickHeight = parseFloat(spectrumParameters.getPeakYPos(tickHeight)) ;
		let y =  tickHeight;
		if(!isNaN(y) &amp;&amp; y >= spectrumParameters.padding.head)//y >= spectrumParameters.padding.head helps the ticks to be in the length of Y axis
		{
			this.addYTicks.append("line")
						.attr("x1",spectrumParameters.padding.left)
						.attr("y1",y)
						.attr("x2",spectrumParameters.padding.left - spectrumParameters.ticklength)
						.attr("y2",y)
						.attr("stroke","black")
						.attr("stroke-width","1")
		}
	}
}
/**
 * Function to draw x-axis and y-axis
 * @param{node} svg -  is a html node on which the graph is being ploted
 */
drawAxis = function(svg,spectrumParameters){
	//Draw x-axis
	this.xAxis = svg.append("g").attr("id", "xaxis").append("line")
					.attr("x1",spectrumParameters.padding.left)
					.attr("y1",spectrumParameters.svgHeight -spectrumParameters.padding.bottom)
					.attr("x2",spectrumParameters.specWidth+spectrumParameters.padding.left)
					.attr("y2",spectrumParameters.svgHeight -spectrumParameters.padding.bottom)
					.attr("stroke","black")
					.attr("stroke-width","2")
	// Draw y-axis
	this.yAxis = svg.append("g").attr("id", "yaxis").append("line")
					.attr("x1",spectrumParameters.padding.left)
					.attr("y1",spectrumParameters.padding.head)
					.attr("x2",spectrumParameters.padding.left)
					.attr("y2",spectrumParameters.svgHeight -spectrumParameters.padding.bottom)
					.attr("stroke","black")
					.attr("stroke-width","2")
}
/**
 * Function to add tick numbers on x and y axis
 * @param{node} svg -  is a html node on which the graph is being ploted
 */
addDatatoAxis = function(svg,spectrumParameters){
	let maxMz = spectrumParameters.maxMz;
	let minMz = spectrumParameters.minMz ;
	// Creating a group wih id 'axisPoints' under which the code to add tick numbers is added  
	this.xAxisData = svg.append("g")
						.attr("id", "xAxisPoints");
						
	for(let i = 0 ; i &lt;=spectrumParameters.xTicks ; i++)
	{
		// Get the default tick width and calculate the actual tick width position based on the current minMz value on the xaxis
		let tickWidth = spectrumParameters.getTickWidth();
		if(tickWidth &lt; 1 &amp;&amp; tickWidth != 0)
		{
			tickWidth = i*tickWidth + spectrumParameters.minMz - parseFloat((i*tickWidth + spectrumParameters.minMz)%tickWidth) ;
		}
		else if(tickWidth != 0)
		{
			tickWidth = i*tickWidth + spectrumParameters.minMz - (i*tickWidth + spectrumParameters.minMz)%tickWidth ;
		}
		x = spectrumParameters.getPeakXPos(tickWidth);
		let l_tickWidth = tickWidth;
		if(x >= spectrumParameters.padding.left &amp;&amp; 
				x &lt;= (spectrumParameters.svgWidth - spectrumParameters.padding.right))
		{
			this.xAxisData.append("text").attr("id","xtext").attr("x",x)
						.attr("y",spectrumParameters.svgHeight - (spectrumParameters.padding.bottom/1.6))// Dividing with 1.6 to set the position of the numbers under the ticks appropriately
						.attr("text-anchor","middle")
						.text(function(){
							// conditions to show more decimal values as we zoom in further and limit decimals when zoomed back
							if(maxMz - minMz &lt;=0.0001) return parseFloat(l_tickWidth).toFixed(6);
							else if(maxMz - minMz &lt;=0.001) return parseFloat(l_tickWidth).toFixed(5);
							else if(maxMz - minMz &lt;=0.01) return parseFloat(l_tickWidth).toFixed(4);
							else if(maxMz - minMz &lt;=0.1) return parseFloat(l_tickWidth).toFixed(3);
							else if(maxMz - minMz &lt;=1) return parseFloat(l_tickWidth).toFixed(2);
							else if(maxMz - minMz &lt;= 3) return parseFloat(l_tickWidth).toFixed(2)
							else if(maxMz - minMz &lt;= 5) return parseFloat(l_tickWidth).toFixed(1)
							return parseInt(l_tickWidth)
						})
						.style("font-size","14px")
		}
	}
	// Creating a group wih id 'axisPoints' under which the code to add tick numbers is added  
	this.yAxisData = svg.append("g")
							.attr("id", "yAxisPoints");
	for(let i = 0 ; i &lt;= spectrumParameters.yTicks ; i++)
	{
		let tickHeight = 0;
		// Get the default tick height and calculate the actual tick height position
		tickHeight = spectrumParameters.getTickHeight();
		let data = i*tickHeight ;
		if(data &lt;= 1 &amp;&amp; data != 0) data = data.toFixed(1);
		tickHeight = i*tickHeight * spectrumParameters.dataMaxInte /100;
		tickHeight = parseFloat(spectrumParameters.getPeakYPos(tickHeight)) ;

		let y =  tickHeight;
		if(!isNaN(y) &amp;&amp; y >= spectrumParameters.padding.head)
		{
			this.yAxisData.append("text").attr("class","ytext").attr("x",spectrumParameters.padding.left - spectrumParameters.ticklength)
						.attr("y",y)
						.attr("text-anchor","end")
						.attr("alignment-baseline","middle")
						.text(data + "%")
						.style("font-size","14px")
		}
	}
}
/**
 * Function to add backGround color to the spectrum graph for MS1 spectrum at precursor mz
 * @param{node} svg -  is a html node on which the graph is being ploted
 */
addBackGround = function(svg,spectrumParameters){
	let svg_temp = svg.append("g")
					.attr("id", "svg_bgColor");

	if(!((spectrumParameters.graphFeatures.bgMinMz &lt; spectrumParameters.minMz &amp;&amp; spectrumParameters.graphFeatures.bgMaxMz &lt; spectrumParameters.minMz) 
		|| (spectrumParameters.graphFeatures.bgMinMz > spectrumParameters.maxMz &amp;&amp; spectrumParameters.graphFeatures.bgMaxMz > spectrumParameters.maxMz)))
	{
		let x = spectrumParameters.getPeakXPos(spectrumParameters.graphFeatures.bgMinMz);
		let x2 = spectrumParameters.getPeakXPos(spectrumParameters.graphFeatures.bgMaxMz);
		if(spectrumParameters.graphFeatures.bgMinMz &lt; spectrumParameters.minMz)
		{
			x = spectrumParameters.getPeakXPos(spectrumParameters.minMz);
		}
		if(spectrumParameters.graphFeatures.bgMaxMz > spectrumParameters.maxMz)
		{
			x2 = spectrumParameters.getPeakXPos(spectrumParameters.maxMz);
		}
		svg_temp.append("rect")
			.attr("x", x)
			.attr("y", spectrumParameters.padding.head)
			.attr("width", x2-x)
			.attr("height", function(){
				let y1 = spectrumParameters.svgHeight - spectrumParameters.padding.bottom;
				let y2 = spectrumParameters.padding.head;
				return y1-y2;
			})
			.style("fill", spectrumParameters.graphFeatures.bgColor)
			.style("fill-opacity", ".4")
			.style("stroke-width", "1.5px");
	}
}
/**
 * Function to draw peak lines on the graph
 * @param{node} svg -  is a html node on which the graph is being ploted
 */
drawPeaks = function(svg,spectrumParameters,peakdata){
	let peaks = svg.append("g")
    				.attr("id", "peaks");
	  var len = peakdata.peak_list.length;
	  // limits provide current count of number of peaks drawn on graph per bin(range) 
	  // so that we can limit tha peak count to peaksPerRange count
	  let limits=[0,0,0,0,0,0,0,0];
	  for(let i =0;i&lt;len;i++)
	  {
		let peak = peakdata.peak_list[i];
		let inLimit = false;
		for(let j=0;j&lt;(spectrumParameters.ranges.length-1);j++)
		{
			if(peak.mz > spectrumParameters.ranges[j] &amp;&amp; peak.mz &lt; spectrumParameters.ranges[j+1])
			{
				limits[j] = limits[j]+1;
				if(limits[j] &lt;= peaksPerRange) inLimit = true;
				break;
			}
		}
		if(peak.mz >= spectrumParameters.minMz &amp;&amp; peak.mz &lt;= spectrumParameters.maxMz &amp;&amp; inLimit == true)
		{
			peaks.append("line")
		  .attr("x1",function(d,i){
			  return spectrumParameters.getPeakXPos(peak.mz);
			  })
		  .attr("y1",function(d,i){
				let y = spectrumParameters.getPeakYPos(peak.intensity);
				if(y&lt;=spectrumParameters.padding.head) return spectrumParameters.padding.head ;
				else return y ;
			  })
		  .attr("x2",function(d,i){
			  	return spectrumParameters.getPeakXPos(peak.mz);
			  })
		  .attr("y2",spectrumParameters.svgHeight - spectrumParameters.padding.bottom )
		  .attr("stroke","black")
		  .attr("stroke-width","2")
		  .on("mouseover",function(d,i){
					onMouseOverPeak(this,peak,spectrumParameters);
				})
			.on("mouseout",function(d,i){
				onPeakMouseOut(this);
			});
		}
	  }
}
/**
 * Function to add circles for the envelope data
 * @param{node} svg -  is a html node on which the graph is being ploted
 */
addCircles = function(svg,spectrumParameters,peakData){
	let circles = svg.append("g").attr("id", "circles");
	let minPercentage = 0.0;
	let maxIntensity = spectrumParameters.dataMaxInte ;
	// limits provide current count of number of peaks drawn on graph per bin(range) 
	// so that we can limit tha peak count to circlesPerRange count
	let limits=[0,0,0,0,0,0,0,0];
	peakData.envelope_list.forEach(function(envelope_list){
		envelope_list.env_peaks.forEach(function(env_peaks){
			//Show only envelopes with minimum of 0.5% 
			let percentInte = env_peaks.intensity/maxIntensity * 100 ;
			let inLimit = false;
			for(let i=0;i&lt;(spectrumParameters.ranges.length-1);i++)
			{
				if(env_peaks.mz > spectrumParameters.ranges[i] &amp;&amp; env_peaks.mz &lt; spectrumParameters.ranges[i+1])
				{
					limits[i] = limits[i]+1;
					if(limits[i] &lt;= circlesPerRange) inLimit = true;
					break;
				}
			}
			// Condition keeps the circles to the right of the y axis till the end of the x-axis
			if(env_peaks.mz > spectrumParameters.minMz &amp;&amp; env_peaks.mz &lt;= spectrumParameters.maxMz &amp;&amp; percentInte >= minPercentage &amp;&amp; inLimit == true)
			{
				circles.append("circle")
				.attr("id","circles")
				.attr("cx",function(d,i){
					return spectrumParameters.getPeakXPos(env_peaks.mz);
				})
				.attr("cy",function(d,i){
					let cy = spectrumParameters.getPeakYPos(env_peaks.intensity);
					if(cy &lt; spectrumParameters.padding.head) return spectrumParameters.padding.head ;
					else return cy ;
				})
				.attr("r",function(d,i){
					return spectrumParameters.getCircleSize();
				})
				.style("fill","white")
				.style("opacity", "0.6")
				.style("stroke",envelope_list.color)
				.style("stroke-width","2")
				.on("mouseover",function(d,i){
					onMouseOverCircle(this,envelope_list,spectrumParameters);
				})
				.on("mouseout",function(d,i){
					onCircleMouseOut(this);
				});
			}
		})
	})
}
/**
 * Function to add IONS at the top of the peaks for each cluster of envelopes
 * @param{node} svg -  is a html node on which the graph is being ploted
 */
drawIons = function(svg,spectrumParameters,ionData){
	let ions = svg.append("g").attr("id", "graph_ions");
	// Get the default tick width and calculate the actual tick width position based on the current minMz value on the xaxis
	let tickWidth = spectrumParameters.getTickWidth();
	ionData.forEach((element)=>{
		if(tickWidth &lt;= spectrumParameters.graphFeatures.tickWidthThreshholdval)
		{
			element.forEach((innerElement)=>{
				placeIonOnGraph_innerFunc(innerElement);
			})
		}else{
			let innerElement = element[0];
			placeIonOnGraph_innerFunc(innerElement);
		}
	})

	// Inner function to draw ions on the graph at respective position
	function placeIonOnGraph_innerFunc(innerElement){
		if(innerElement.mz > spectrumParameters.minMz &amp;&amp; innerElement.mz &lt;= spectrumParameters.maxMz)
		{
			ions.append("text")
			.attr("id","graph_matched_ions")
			.attr("x",(spectrumParameters.getPeakXPos((innerElement.mz))-spectrumParameters.graphFeatures.adjustableIonPosition))
			.attr("y",function(d,i){
				let y = spectrumParameters.getPeakYPos(innerElement.intensity + (0.1*innerElement.intensity));// Adding 10% to get the Ions on the max Intensity Peak
				y = y - spectrumParameters.graphFeatures.fixedHeightOfIonAboveThePeak;
				if(y &lt;= spectrumParameters.padding.head) return spectrumParameters.padding.head ;
				else return y ;
				})
			.style("fill","black")
			.style("opacity", "0.6")
			.style("stroke-width","2")
			.text(innerElement.ion);
		}
	}
}
/**
 * Function to add Acid names at the top of the graph divided by | symbol
 * @param{node} svg -  is a html node on which the graph is being ploted
 */
drawSequence = function(svg,spectrumParameters){
	let seqSvg = svg.append("g").attr("id", "graph_sequence");
	let sequenceData = spectrumParameters.graphFeatures.prefixSequenceData;
	let x,y,text;
	// Draw | at 0 for prefix mass list
	x = spectrumParameters.getPeakXPos((0));
	y = spectrumParameters.padding.head-40;
	text = "|";
	drawAcids_innerFunc(seqSvg,x,y,text);
	sequenceData.forEach(function(element,index,prefixSequenceData){
		if(element.mass > spectrumParameters.minMz &amp;&amp; element.mass &lt;= spectrumParameters.maxMz)
		{
			let x1 = spectrumParameters.getPeakXPos(0);
			if(index != 0) x1 = spectrumParameters.getPeakXPos(prefixSequenceData[index-1].mass);
			x2 = spectrumParameters.getPeakXPos((element.mass));
			x = (x1+x2)/2;
			y = spectrumParameters.padding.head-40;
			drawAcids_innerFunc(seqSvg,x,y,element.acid);
			drawAcids_innerFunc(seqSvg,x2,y,"|");
		}
	})

	sequenceData = spectrumParameters.graphFeatures.suffixSequeceData;
	// Draw | at water mass for suffix mass list
	x = spectrumParameters.getPeakXPos(18.010564683704);// Mass of water=18.010564683704
	y = spectrumParameters.padding.head-20;
	text = "|";
	drawAcids_innerFunc(seqSvg,x,y,text);
	sequenceData.forEach(function(element,index,suffixSequeceData){
		if(element.mass > spectrumParameters.minMz &amp;&amp; element.mass &lt;= spectrumParameters.maxMz)
		{
			let x1 = spectrumParameters.getPeakXPos(18.010564683704);// Mass of water=18.010564683704
			if(index != 0) x1 = spectrumParameters.getPeakXPos(suffixSequeceData[index-1].mass);
			x2 = spectrumParameters.getPeakXPos((element.mass));
			x = (x1+x2)/2;
			y = spectrumParameters.padding.head-20;
			drawAcids_innerFunc(seqSvg,x,y,element.acid);
			drawAcids_innerFunc(seqSvg,x2,y,"|");
		}
	})
	function drawAcids_innerFunc(svgId,x,y,text){
		svgId.append("text")
			.attr("id","")
			.attr("x",x)
			.attr("y",y)
			.style("fill","black")
			.style("opacity", "0.6")
			.style("stroke-width","2")
			.text(text);
	}
}
/**
 * Function to add labels on x and y axis
 * @param{node} svg -  is a html node on which the graph is being ploted
 */
addLabels = function(svg, spectrumParameters){

	svg.append("text").attr("id","label")
						.attr("transform","translate(" + (spectrumParameters.svgWidth/2) + "," + (spectrumParameters.svgHeight-spectrumParameters.labelAdjustVal) + ")")
					.attr("fill","black")
					    .attr("font-family","Helvetica Neue,Helvetica,Arial,sans-serif")
					    .attr("font-size","16px")
					    .text("m/z");
	svg.append("text").attr("id","label")
					.attr("transform", "translate("+ spectrumParameters.padding.left/3 +","+(spectrumParameters.svgHeight/2+spectrumParameters.labelAdjustVal)+")rotate(-90)")
					.attr("fill","black")
					    .attr("font-family","Helvetica Neue,Helvetica,Arial,sans-serif")
					    .attr("font-size","16px")
					    .text("Intensity");
}
/**
 * Function to show the data of Mass and Intensity on mouse over of peaks
 * @param{node} svg -  is a html node on which the graph is being ploted
 */
onMouseOverPeak = function(this_element,peak,spectrumParameters)
{
	let x = spectrumParameters.getPeakXPos(peak.mz);
	let y = spectrumParameters.getPeakYPos(peak.intensity);
	intensity =" I:"+ parseFloat(peak.intensity).toFixed(3);
	mz = "M:"+parseFloat(peak.mz).toFixed(3);
	y = y - spectrumParameters.mouseOverPadding.head ;
	if(y&lt;=spectrumParameters.mouseOverPadding.head)
	{
		y = spectrumParameters.mouseOverPadding.head;
	}
	d3.select(this_element).style("stroke","red")
							.style("stroke-width","2");
	
	let tooltipData = mz + "&lt;br>" + intensity ;						
	/*	Rectangle to have flexible on click and on mouse actions	*/
	var div = d3.select("body").append("div")
							.attr("id", "MyTextMZIN")	
							.attr("class", "tooltip")	
							
	div.transition().duration(30)	
					.style("opacity", 2);
	div.html(tooltipData).style("left", (d3.event.pageX + 12)  + "px")		
				.style("top", (d3.event.pageY - 28)+ "px")
				.style("fill", "black");
}
/**
 * Function to show the data of Mass and Intensity on mouse over of circles
 * @param{node} svg -  is a html node on which the graph is being ploted
 */
onMouseOverCircle = function(this_element,envelope_list,spectrumParameters)
{
	let x = parseFloat(d3.select(this_element).attr("cx"));
	let y = parseFloat(d3.select(this_element).attr("cy")) ;
	let mass = "Mass:"+envelope_list.mono_mass.toFixed(2);
	let charge = "Charge:"+ envelope_list.charge ;
	y = y - spectrumParameters.mouseOverPadding.head ;
	if(y&lt;=spectrumParameters.mouseOverPadding.head)
	{
		y = spectrumParameters.mouseOverPadding.head;
	}
	
	let tooltipData = mass + "&lt;br>" + charge ;						
	/*	Rectangle to have flexible on click and on mouse actions	*/
	var div = d3.select("body").append("div")
							.attr("id", "MyTextMassCharge")	
							.attr("class", "tooltip")
							
	div.transition().duration(30)	
					.style("opacity", 2);
	div.html(tooltipData).style("left", (d3.event.pageX + 12)  + "px")		
				.style("top", (d3.event.pageY - 28)+ "px")
				.style("fill", "black");
}
/**
 * Function to reset to the original on mouse out of peaks
 */
onPeakMouseOut = function(this_element)
{
	onMouseOut();
	d3.select(this_element).style("stroke","black");
}
/**
 * Function to reset to the original on mouse out of circle
 */
onCircleMouseOut= function(){
	onMouseOut();
}
/**
 * Function to remove the tooltips on mouseout
 */
onMouseOut = function(){
	d3.selectAll("#MyTextMZIN").remove();
	d3.selectAll("#MyTextMassCharge").remove();
}
/**
 * Function gets invokes whenever zoom or drag is invoked and redraws the graph whenever there is zoom or draw
 * This function invokes all the functions that draw the graph
 * @param {string} svgId - Contains the Id from html on which the graph should be drawn
 * @param {object} spectrumParameters - Contains the parameters to help draw the graph
 * @param {list} peakData - Contains the data of Peaks and Envelopes to draws lines and circles on the graph
 * @param {list} ionData - Contains Ions to draw upon the peaks
 */
function drawSpectrum(svgId, spectrumParameters, peakData,ionData){
	let svg = d3.select("body").select(svgId);
	// Removes all the elements under SVG group 'svgGroup' everytime there this function is called
	svg.selectAll("#svgGroup").remove();
	// Create a group under which all the fucntions of the graph will be appended
	svg = svg.append("g").attr("id","svgGroup");
	
	/*call onMouseOut everytime to fix onHover bug adding multiple data when mouseover and zoomed up*/
	onMouseOut();
	drawTicks(svg, spectrumParameters);
	drawAxis(svg,spectrumParameters);
	addDatatoAxis(svg,spectrumParameters);
	addLabels(svg, spectrumParameters);
	// Condition if background color is needed to be added for specific graph
	if(spectrumParameters.graphFeatures.isAddbgColor)
	{
		addBackGround(svg, spectrumParameters);
	}
	drawPeaks(svg, spectrumParameters, peakData);
	if(spectrumParameters.graphFeatures.showCircles &amp;&amp; peakData.envelope_list != null)
	{
		addCircles(svg,spectrumParameters,peakData);
	}
	if(spectrumParameters.graphFeatures.showIons &amp;&amp; ionData != null)
	{
		drawIons(svg,spectrumParameters,ionData);
	}
	if(spectrumParameters.graphFeatures.showSequene)
	{
		drawSequence(svg,spectrumParameters);
	}
	return spectrumParameters;
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="-_anonymous_-altEditor.classes.html">classes</a></li><li><a href="-_anonymous_-altEditor.defaults.html">defaults</a></li><li><a href="-_ext.type.html">type</a></li><li><a href="Common%2520and%2520useful%2520DOM%2520elements%2520for%2520the%2520class%2520instance.html">Common and useful DOM elements for the class instance</a></li><li><a href="DataTable.defaults.html">defaults</a></li><li><a href="DataTable.defaults.classes.html">classes</a></li><li><a href="DataTable.defaults.html#.column">column</a></li><li><a href="DataTable.defaults.language.html">language</a></li><li><a href="DataTable.defaults.language.aria.html">aria</a></li><li><a href="DataTable.defaults.language.paginate.html">paginate</a></li><li><a href="DataTable.defaults.search.html">search</a></li><li><a href="DataTable.ext.html">ext</a></li><li><a href="DataTable.models.html">models</a></li><li><a href="DataTable.models.oColumn.html">oColumn</a></li><li><a href="DataTable.models.oRow.html">oRow</a></li><li><a href="DataTable.models.oSearch.html">oSearch</a></li><li><a href="DataTable.models.oSettings.html">oSettings</a></li><li><a href="DataTable.models.oSettings.oBrowser.html">oBrowser</a></li><li><a href="DataTable.models.oSettings.oFeatures.html">oFeatures</a></li><li><a href="DataTable.models.oSettings.oLanguage.html">oLanguage</a></li><li><a href="DataTable.models.oSettings.oPreviousSearch.html">oPreviousSearch</a></li><li><a href="DataTable.models.oSettings.oScroll.html">oScroll</a></li><li><a href="DataTable.render.html">render</a></li><li><a href="DataTable.util.html">util</a></li><li><a href="Settings%2520object%2520which%2520contains%2520customisable%2520information%250A%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520for%2520altEditor%2520instance.html">Settings object which contains customisable information
           for altEditor instance</a></li></ul><h3>Classes</h3><ul><li><a href="CalculateEmassAndDistribution.html">CalculateEmassAndDistribution</a></li><li><a href="Constants.html">Constants</a></li><li><a href="DataTable.Api.html">Api</a></li><li><a href="GetMassTableOfSelectedIons.html">GetMassTableOfSelectedIons</a></li><li><a href="MolecularFormulae.html">MolecularFormulae</a></li><li><a href="SpectrumDownload.html">SpectrumDownload</a></li><li><a href="DataTable_.html">~DataTable</a></li></ul><h3>Events</h3><ul><li><a href="DataTable_column-sizing.html#.event:dt">dt</a></li><li><a href="DataTable_column-visibility.html#.event:dt">dt</a></li><li><a href="DataTable_destroy.html#.event:dt">dt</a></li><li><a href="DataTable_draw.html#.event:dt">dt</a></li><li><a href="DataTable_init.html#.event:dt">dt</a></li><li><a href="DataTable_length.html#.event:dt">dt</a></li><li><a href="DataTable_order.html#.event:dt">dt</a></li><li><a href="DataTable_page.html#.event:dt">dt</a></li><li><a href="DataTable_processing.html#.event:dt">dt</a></li><li><a href="DataTable_search.html#.event:dt">dt</a></li><li><a href="DataTable_stateLoaded.html#.event:dt">dt</a></li><li><a href="DataTable_stateLoadParams.html#.event:dt">dt</a></li><li><a href="DataTable_stateSaveParams.html#.event:dt">dt</a></li><li><a href="DataTable_xhr.html#.event:dt">dt</a></li></ul><h3>Global</h3><ul><li><a href="global.html#$">$</a></li><li><a href="global.html#_">_</a></li><li><a href="global.html#_addRowCallback">_addRowCallback</a></li><li><a href="global.html#_addRowData">_addRowData</a></li><li><a href="global.html#_deleteRow">_deleteRow</a></li><li><a href="global.html#_deleteRowCallback">_deleteRowCallback</a></li><li><a href="global.html#_editRowCallback">_editRowCallback</a></li><li><a href="global.html#_editRowData">_editRowData</a></li><li><a href="global.html#_errorCallback">_errorCallback</a></li><li><a href="global.html#addBackGround">addBackGround</a></li><li><a href="global.html#addCircles">addCircles</a></li><li><a href="global.html#addDatatoAxis">addDatatoAxis</a></li><li><a href="global.html#addLabels">addLabels</a></li><li><a href="global.html#addSpectrum">addSpectrum</a></li><li><a href="global.html#api">api</a></li><li><a href="global.html#calibrateCoordinates">calibrateCoordinates</a></li><li><a href="global.html#calibrateLeftNum">calibrateLeftNum</a></li><li><a href="global.html#calibrateRightNum">calibrateRightNum</a></li><li><a href="global.html#calibrateSkipEnd">calibrateSkipEnd</a></li><li><a href="global.html#calibrateSkipStart">calibrateSkipStart</a></li><li><a href="global.html#checkWaitTasks">checkWaitTasks</a></li><li><a href="global.html#completeColumnDefs">completeColumnDefs</a></li><li><a href="global.html#createDialog">createDialog</a></li><li><a href="global.html#drag">drag</a></li><li><a href="global.html#drawAxis">drawAxis</a></li><li><a href="global.html#drawIons">drawIons</a></li><li><a href="global.html#drawPeaks">drawPeaks</a></li><li><a href="global.html#drawSequence">drawSequence</a></li><li><a href="global.html#drawSpectrum">drawSpectrum</a></li><li><a href="global.html#drawTicks">drawTicks</a></li><li><a href="global.html">Edit a row</a></li><li><a href="global.html#fnAddData">fnAddData</a></li><li><a href="global.html#fnAdjustColumnSizing">fnAdjustColumnSizing</a></li><li><a href="global.html#fnClearTable">fnClearTable</a></li><li><a href="global.html#fnClose">fnClose</a></li><li><a href="global.html#fnDeleteRow">fnDeleteRow</a></li><li><a href="global.html#fnDestroy">fnDestroy</a></li><li><a href="global.html#fnDraw">fnDraw</a></li><li><a href="global.html#fnFilter">fnFilter</a></li><li><a href="global.html#fnGetData">fnGetData</a></li><li><a href="global.html#fnGetNodes">fnGetNodes</a></li><li><a href="global.html#fnGetPosition">fnGetPosition</a></li><li><a href="global.html#fnIsOpen">fnIsOpen</a></li><li><a href="global.html#fnOpen">fnOpen</a></li><li><a href="global.html#fnPageChange">fnPageChange</a></li><li><a href="global.html#fnSetColumnVis">fnSetColumnVis</a></li><li><a href="global.html#fnSettings">fnSettings</a></li><li><a href="global.html#fnSort">fnSort</a></li><li><a href="global.html#fnSortListener">fnSortListener</a></li><li><a href="global.html#fnUpdate">fnUpdate</a></li><li><a href="global.html#fnVersionCheck">fnVersionCheck</a></li><li><a href="global.html#getAminoAcidDistribution">getAminoAcidDistribution</a></li><li><a href="global.html#getCircleSize">getCircleSize</a></li><li><a href="global.html#getEnvelopeData">getEnvelopeData</a></li><li><a href="global.html#getIonData">getIonData</a></li><li><a href="global.html#getIsotopicMassOfAtom">getIsotopicMassOfAtom</a></li><li><a href="global.html#getIsotopicMassRef">getIsotopicMassRef</a></li><li><a href="global.html#getNormalizedIntensity">getNormalizedIntensity</a></li><li><a href="global.html#getPeakXPos">getPeakXPos</a></li><li><a href="global.html#getPeakYPos">getPeakYPos</a></li><li><a href="global.html#getTickHeight">getTickHeight</a></li><li><a href="global.html#getTickWidth">getTickWidth</a></li><li><a href="global.html#getY">getY</a></li><li><a href="global.html#groupBy">groupBy</a></li><li><a href="global.html#initScale">initScale</a></li><li><a href="global.html#job">job</a></li><li><a href="global.html#onAddRow">onAddRow</a></li><li><a href="global.html#onCircleMouseOut">onCircleMouseOut</a></li><li><a href="global.html#onclickTopView">onclickTopView</a></li><li><a href="global.html#onDeleteRow">onDeleteRow</a></li><li><a href="global.html#onDragLimits">onDragLimits</a></li><li><a href="global.html#onEditRow">onEditRow</a></li><li><a href="global.html#onMouseOut">onMouseOut</a></li><li><a href="global.html#onMouseOverCircle">onMouseOverCircle</a></li><li><a href="global.html#onMouseOverPeak">onMouseOverPeak</a></li><li><a href="global.html#onPeakMouseOut">onPeakMouseOut</a></li><li><a href="global.html#parameters">parameters</a></li><li><a href="global.html#reloadOptions">reloadOptions</a></li><li><a href="global.html#setLimits">setLimits</a></li><li><a href="global.html#showAllPeaks">showAllPeaks</a></li><li><a href="global.html#showIonPeaks">showIonPeaks</a></li><li><a href="global.html#showMatchedPeaks">showMatchedPeaks</a></li><li><a href="global.html#showNonMatchedPeaks">showNonMatchedPeaks</a></li><li><a href="global.html#showNotMatchedPeaks">showNotMatchedPeaks</a></li><li><a href="global.html#sortEnvelopes">sortEnvelopes</a></li><li><a href="global.html#SpectrumGraph">SpectrumGraph</a></li><li><a href="global.html#svgIds">svgIds</a></li><li><a href="global.html#updateSeq">updateSeq</a></li><li><a href="global.html#xZoom">xZoom</a></li><li><a href="global.html#yZoom">yZoom</a></li><li><a href="global.html#zoom">zoom</a></li><li><a href="global.html#%257BonClickSequenceOfExecution%257Dexecuteswhenuserentersmassshiftonanyaminoacidandclick%2522OK%2522button.">{onClickSequenceOfExecution} executes when user enters mass shift 
on any amino acid and click "OK" button.</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Thu Apr 16 2020 16:10:17 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
