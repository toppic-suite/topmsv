<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: public/resources/topview/js/spectrum_graph/spectrumdownload.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: public/resources/topview/js/spectrum_graph/spectrumdownload.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Class to execute download operations for the spectrum graph
 */
class SpectrumDownload {
    //Unique Id values for graph and download buttons 
    static SPECDOWNLOADPNG = "spectrum_download_png";
    static SPECDOWNLOADSVG = "spectrum_download_svg";
    static downloadbuttonX = 41;
    static spanWidth = 50;
    static downloadButtonWidth = 30;
    static downloadButtonHeight = 30;
    static buttonWidth = 50;
    static buttonHeight = 28;
    static buttonOne_Y = 33;
    static buttonTwo_Y = 60;
    //default costructor
    constructor(){
    }
    /**
     * Draw a rectangular block to keep download image
     */
    static addDownloadRect = function(svgId,spectrumParameters){
        d3.select("#g_spectrum_button").remove();
        let svg = d3.select("body").select(svgId);
        let group = svg.append("g").attr("id","g_spectrum_button");
    
        group.append("svg:image").attr("id","spectrum_download")
             .attr('x', (spectrumParameters.svgWidth-SpectrumDownload.downloadbuttonX))
             .attr('y', 0)//top most point in svg
             .attr('width', SpectrumDownload.downloadButtonWidth)
             .attr('height', SpectrumDownload.downloadButtonHeight)
             .attr("xlink:href", "../js/spectrum_graph/images/download.png")	
    
        d3.selectAll("#g_spectrum_button").on('mouseover',function(){
                d3.select(this).style("cursor", "pointer"); 
                })
                .on('mouseout',function(){
                    d3.select(this).style("cursor", "default"); 
                });
        $("#spectrum_download").on("click",function(){
            d3.selectAll(".downloadgraph_button").remove();
            SpectrumDownload.addDownloadbuttons(svgId,spectrumParameters);
        });
    }
    /**
     * Setting images as download buttons
     */
    static addDownloadbuttons = function(svgId,spectrumParameters){
        let group = d3.select("#g_spectrum_button");
        group.append("svg:image").attr("id",SpectrumDownload.SPECDOWNLOADSVG)
            .attr("class","downloadgraph_button")
            .attr('x', (spectrumParameters.svgWidth-SpectrumDownload.spanWidth))
            .attr('y', SpectrumDownload.buttonOne_Y)
            .attr('width', SpectrumDownload.buttonWidth)
            .attr('height', SpectrumDownload.buttonHeight)
            .attr("xlink:href", "../js/spectrum_graph/images/svg.png")
            .on("click",function(){
                SpectrumDownload.popup("svg",spectrumParameters,svgId);
            });
        
        group.append("svg:image").attr("id",SpectrumDownload.SPECDOWNLOADPNG)
            .attr("class","downloadgraph_button")
            .attr('x', (spectrumParameters.svgWidth-SpectrumDownload.spanWidth))
            .attr('y', SpectrumDownload.buttonTwo_Y)
            .attr('width', SpectrumDownload.buttonWidth)
            .attr('height', SpectrumDownload.buttonHeight)
            .attr("xlink:href", "../js/spectrum_graph/images/png.png")
            .on("click",function(){
                SpectrumDownload.popup("png",spectrumParameters,svgId);
            });
        //SpectrumDownload.download(svgId,spectrumParameters);
    }
    /**
     * On click action to download spectrum graph as SVG/PNG
     */
    static download = function(type,spectrumParameters,svgId,imagename){
       if(type == "svg")
       {
            $("#g_spectrum_button").remove();
            let  name = imagename+".svg";
            let svg_element = d3.selectAll(svgId).node();
            svg2svg(svg_element,name);
            
       }else{
            $("#g_spectrum_button").remove();
            let l_svgContainer = d3.select(svgId);
            let svgString = getSVGString(l_svgContainer.node());
            //let svg_element = document.getElementById(SpectrumDownload.SPECTRUMGRAPHID);
            //let bBox = svg_element.getBBox();
            let name = imagename+".png";
            let width = spectrumParameters.svgWidth;
            let height = spectrumParameters.svgHeight ;
            svgString2Image( svgString, 2*width, 2*height, 'png', save ); 
            function save( dataBlob, filesize ){
                saveAs( dataBlob, name ); 
            }
       } 
       SpectrumDownload.addDownloadRect(svgId,spectrumParameters);
       $('#tooltip_imagename').remove();   
            
    }
    static popup =  function(type,spectrumParameters,svgId){
        console.log("in popup");
        d3.selectAll("#tooltip_imagename").remove() ;
        var div = d3.select("body").append("div")
        .attr("class", "tooltip")
        .attr("id","tooltip_imagename")
        .style("opacity", 1);

        div.transition()
        .duration(200)
        .style("opacity", .9);
        div.html(
                '&lt;input type="text" placeholder="Image Name" id="imagename" />'+
                '&lt;button id="saveimage" style = "none" type="button">save&lt;/button>'
                )
        .style("left", (d3.event.pageX - 30) + "px")             
        .style("top", (d3.event.pageY - 45) + "px")
        // .style("transform","translateX(-35%)!important")
        .attr("box-sizing","border")
        .attr("display","inline-block")
        .attr("min-width","1.5em")
        .attr("padding","2px")
        .attr("margin-left","0px")
        .attr("text-align","center")
        .attr("text-decoration","none")
        .attr("border","1px solid #111111")
        .attr("background-color","white");

        $("#saveimage").click(function(){
            let imagename = $("#imagename").val();
            if( imagename == null || imagename == "")
            {
                imagename = "spectrum";
            }
            SpectrumDownload.download(type,spectrumParameters,svgId, imagename);
        })
        
    }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="-_anonymous_-altEditor.classes.html">classes</a></li><li><a href="-_anonymous_-altEditor.defaults.html">defaults</a></li><li><a href="-_ext.type.html">type</a></li><li><a href="Common%2520and%2520useful%2520DOM%2520elements%2520for%2520the%2520class%2520instance.html">Common and useful DOM elements for the class instance</a></li><li><a href="DataTable.defaults.html">defaults</a></li><li><a href="DataTable.defaults.classes.html">classes</a></li><li><a href="DataTable.defaults.html#.column">column</a></li><li><a href="DataTable.defaults.language.html">language</a></li><li><a href="DataTable.defaults.language.aria.html">aria</a></li><li><a href="DataTable.defaults.language.paginate.html">paginate</a></li><li><a href="DataTable.defaults.search.html">search</a></li><li><a href="DataTable.ext.html">ext</a></li><li><a href="DataTable.models.html">models</a></li><li><a href="DataTable.models.oColumn.html">oColumn</a></li><li><a href="DataTable.models.oRow.html">oRow</a></li><li><a href="DataTable.models.oSearch.html">oSearch</a></li><li><a href="DataTable.models.oSettings.html">oSettings</a></li><li><a href="DataTable.models.oSettings.oBrowser.html">oBrowser</a></li><li><a href="DataTable.models.oSettings.oFeatures.html">oFeatures</a></li><li><a href="DataTable.models.oSettings.oLanguage.html">oLanguage</a></li><li><a href="DataTable.models.oSettings.oPreviousSearch.html">oPreviousSearch</a></li><li><a href="DataTable.models.oSettings.oScroll.html">oScroll</a></li><li><a href="DataTable.render.html">render</a></li><li><a href="DataTable.util.html">util</a></li><li><a href="Settings%2520object%2520which%2520contains%2520customisable%2520information%250A%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520for%2520altEditor%2520instance.html">Settings object which contains customisable information
           for altEditor instance</a></li></ul><h3>Classes</h3><ul><li><a href="CalculateEmassAndDistribution.html">CalculateEmassAndDistribution</a></li><li><a href="Constants.html">Constants</a></li><li><a href="DataTable.Api.html">Api</a></li><li><a href="GetMassTableOfSelectedIons.html">GetMassTableOfSelectedIons</a></li><li><a href="MolecularFormulae.html">MolecularFormulae</a></li><li><a href="SpectrumDownload.html">SpectrumDownload</a></li><li><a href="DataTable_.html">~DataTable</a></li></ul><h3>Events</h3><ul><li><a href="DataTable_column-sizing.html#.event:dt">dt</a></li><li><a href="DataTable_column-visibility.html#.event:dt">dt</a></li><li><a href="DataTable_destroy.html#.event:dt">dt</a></li><li><a href="DataTable_draw.html#.event:dt">dt</a></li><li><a href="DataTable_init.html#.event:dt">dt</a></li><li><a href="DataTable_length.html#.event:dt">dt</a></li><li><a href="DataTable_order.html#.event:dt">dt</a></li><li><a href="DataTable_page.html#.event:dt">dt</a></li><li><a href="DataTable_processing.html#.event:dt">dt</a></li><li><a href="DataTable_search.html#.event:dt">dt</a></li><li><a href="DataTable_stateLoaded.html#.event:dt">dt</a></li><li><a href="DataTable_stateLoadParams.html#.event:dt">dt</a></li><li><a href="DataTable_stateSaveParams.html#.event:dt">dt</a></li><li><a href="DataTable_xhr.html#.event:dt">dt</a></li></ul><h3>Global</h3><ul><li><a href="global.html#$">$</a></li><li><a href="global.html#_">_</a></li><li><a href="global.html#_addRowCallback">_addRowCallback</a></li><li><a href="global.html#_addRowData">_addRowData</a></li><li><a href="global.html#_deleteRow">_deleteRow</a></li><li><a href="global.html#_deleteRowCallback">_deleteRowCallback</a></li><li><a href="global.html#_editRowCallback">_editRowCallback</a></li><li><a href="global.html#_editRowData">_editRowData</a></li><li><a href="global.html#_errorCallback">_errorCallback</a></li><li><a href="global.html#addBackGround">addBackGround</a></li><li><a href="global.html#addCircles">addCircles</a></li><li><a href="global.html#addDatatoAxis">addDatatoAxis</a></li><li><a href="global.html#addLabels">addLabels</a></li><li><a href="global.html#addSpectrum">addSpectrum</a></li><li><a href="global.html#api">api</a></li><li><a href="global.html#calibrateCoordinates">calibrateCoordinates</a></li><li><a href="global.html#calibrateLeftNum">calibrateLeftNum</a></li><li><a href="global.html#calibrateRightNum">calibrateRightNum</a></li><li><a href="global.html#calibrateSkipEnd">calibrateSkipEnd</a></li><li><a href="global.html#calibrateSkipStart">calibrateSkipStart</a></li><li><a href="global.html#checkWaitTasks">checkWaitTasks</a></li><li><a href="global.html#completeColumnDefs">completeColumnDefs</a></li><li><a href="global.html#createDialog">createDialog</a></li><li><a href="global.html#drag">drag</a></li><li><a href="global.html#drawAxis">drawAxis</a></li><li><a href="global.html#drawIons">drawIons</a></li><li><a href="global.html#drawPeaks">drawPeaks</a></li><li><a href="global.html#drawSequence">drawSequence</a></li><li><a href="global.html#drawSpectrum">drawSpectrum</a></li><li><a href="global.html#drawTicks">drawTicks</a></li><li><a href="global.html">Edit a row</a></li><li><a href="global.html#fnAddData">fnAddData</a></li><li><a href="global.html#fnAdjustColumnSizing">fnAdjustColumnSizing</a></li><li><a href="global.html#fnClearTable">fnClearTable</a></li><li><a href="global.html#fnClose">fnClose</a></li><li><a href="global.html#fnDeleteRow">fnDeleteRow</a></li><li><a href="global.html#fnDestroy">fnDestroy</a></li><li><a href="global.html#fnDraw">fnDraw</a></li><li><a href="global.html#fnFilter">fnFilter</a></li><li><a href="global.html#fnGetData">fnGetData</a></li><li><a href="global.html#fnGetNodes">fnGetNodes</a></li><li><a href="global.html#fnGetPosition">fnGetPosition</a></li><li><a href="global.html#fnIsOpen">fnIsOpen</a></li><li><a href="global.html#fnOpen">fnOpen</a></li><li><a href="global.html#fnPageChange">fnPageChange</a></li><li><a href="global.html#fnSetColumnVis">fnSetColumnVis</a></li><li><a href="global.html#fnSettings">fnSettings</a></li><li><a href="global.html#fnSort">fnSort</a></li><li><a href="global.html#fnSortListener">fnSortListener</a></li><li><a href="global.html#fnUpdate">fnUpdate</a></li><li><a href="global.html#fnVersionCheck">fnVersionCheck</a></li><li><a href="global.html#getAminoAcidDistribution">getAminoAcidDistribution</a></li><li><a href="global.html#getCircleSize">getCircleSize</a></li><li><a href="global.html#getEnvelopeData">getEnvelopeData</a></li><li><a href="global.html#getIonData">getIonData</a></li><li><a href="global.html#getIsotopicMassOfAtom">getIsotopicMassOfAtom</a></li><li><a href="global.html#getIsotopicMassRef">getIsotopicMassRef</a></li><li><a href="global.html#getNormalizedIntensity">getNormalizedIntensity</a></li><li><a href="global.html#getPeakXPos">getPeakXPos</a></li><li><a href="global.html#getPeakYPos">getPeakYPos</a></li><li><a href="global.html#getTickHeight">getTickHeight</a></li><li><a href="global.html#getTickWidth">getTickWidth</a></li><li><a href="global.html#getY">getY</a></li><li><a href="global.html#groupBy">groupBy</a></li><li><a href="global.html#initScale">initScale</a></li><li><a href="global.html#job">job</a></li><li><a href="global.html#onAddRow">onAddRow</a></li><li><a href="global.html#onCircleMouseOut">onCircleMouseOut</a></li><li><a href="global.html#onclickTopView">onclickTopView</a></li><li><a href="global.html#onDeleteRow">onDeleteRow</a></li><li><a href="global.html#onDragLimits">onDragLimits</a></li><li><a href="global.html#onEditRow">onEditRow</a></li><li><a href="global.html#onMouseOut">onMouseOut</a></li><li><a href="global.html#onMouseOverCircle">onMouseOverCircle</a></li><li><a href="global.html#onMouseOverPeak">onMouseOverPeak</a></li><li><a href="global.html#onPeakMouseOut">onPeakMouseOut</a></li><li><a href="global.html#parameters">parameters</a></li><li><a href="global.html#reloadOptions">reloadOptions</a></li><li><a href="global.html#setLimits">setLimits</a></li><li><a href="global.html#showAllPeaks">showAllPeaks</a></li><li><a href="global.html#showIonPeaks">showIonPeaks</a></li><li><a href="global.html#showMatchedPeaks">showMatchedPeaks</a></li><li><a href="global.html#showNonMatchedPeaks">showNonMatchedPeaks</a></li><li><a href="global.html#showNotMatchedPeaks">showNotMatchedPeaks</a></li><li><a href="global.html#sortEnvelopes">sortEnvelopes</a></li><li><a href="global.html#SpectrumGraph">SpectrumGraph</a></li><li><a href="global.html#svgIds">svgIds</a></li><li><a href="global.html#updateSeq">updateSeq</a></li><li><a href="global.html#xZoom">xZoom</a></li><li><a href="global.html#yZoom">yZoom</a></li><li><a href="global.html#zoom">zoom</a></li><li><a href="global.html#%257BonClickSequenceOfExecution%257Dexecuteswhenuserentersmassshiftonanyaminoacidandclick%2522OK%2522button.">{onClickSequenceOfExecution} executes when user enters mass shift 
on any amino acid and click "OK" button.</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Thu Apr 16 2020 16:10:17 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
